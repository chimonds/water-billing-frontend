<md-content>
  <md-card>
    <md-card-content>
      <form name="myForm.object">
        <table  width="100%">
          <tr>
            <td width="50%" valign="top">
              <div style="padding-right: 30px;">
                <table width="100%">
                <tr>
                  <td colspan="2">
                    <md-subheader class="md-primary">
                      Use this panel to bill accounts
                    </md-subheader>
                  </td>
                </tr>
                <tr ng-show="accountFound">
                  <td colspan="2">
                    <h2>{{data.accName}}</h2>
                  </td>
                </tr>
                <tr ng-show="accountFound">
                  <td>
                    <!--Left table-->
                    <table>
                      <tr>
                        <td>Account no</td>
                        <td><h3>{{data.accNo}}</h3></td>
                      </tr>
                      <tr>
                        <td>Tariff</td>
                        <td><h3>{{data.tariff.name}}</h3></td>
                      </tr>
                      <!--<tr>-->
                        <!--<td>Previous Reading</td>-->
                        <!--<td><h3>{{lastBill.currentReading | number}}</h3></td>-->
                      <!--</tr>-->
                      <tr>
                        <td>Average</td>
                        <td><h3>{{data.averageConsumption}}</h3></td>
                      </tr>
                      <tr>
                        <td>Status</td>
                        <td><h3>{{data.accountStatus}}</h3></td>
                      </tr>
                      <tr>
                        <td>Balance</td>
                        <td><h3>{{data.outstandingBalance | number}}</h3></td>
                      </tr>
                    </table>
                  </td>
                  <td align="right">
                    <!--Right table here-->
                    <table cellspacing="4">
                      <tr>
                        <td>Last Bill Month</td>
                        <td align="right"><h3>{{lastBill.billingMonth.month | date:'MMM, yyyy'}}</h3></td>
                      </tr>
                      <tr>
                        <td>Metered</td>
                        <td align="right"><h3>{{data.metered}}</h3></td>
                      </tr>
                      <tr>
                        <td>Meter Owner</td>
                        <td align="right">
                          <h3>
                            {{data.meter.meterOwner.name}}
                          </h3>
                        </td>
                      </tr>
                      <tr>
                        <td>Meter Rent</td>
                        <td align="right"><h3>{{data.meter.meterSize.rentAmount | number}}</h3></td>
                      </tr>

                      <tr>
                        <td>Billed this month</td>
                        <td align="right"><h3>{{lastBill.billed}}</h3></td>
                      </tr>
                    </table>
                  </td>
                </tr>
              </table>
              </div>
            </td>
            <td width="50%" valign="top">
              <div style="padding-left: 30px; border-left: 1px solid #ccc;">
              <table width="100%">
                <tr>
                  <td align="right">
                    <md-subheader class="md-primary">
                      Billing Month: {{activeBillingMonth.month | date:'MMM, yyyy'}}
                    </md-subheader>
                  </td>
                </tr>
                <tr>
                  <td>
                    <md-content  flex>
                        <md-input-container flex="90" class="md-default-theme">
                          <label for="input_041">Search account</label>
                          <input ng-change="searchAccount()" ng-model="form.accNo" maxlength="12"
                                 class="ng-pristine ng-valid md-input ng-touched" tabindex="0" id="input_041"
                                 aria-invalid="false">
                        </md-input-container>
                        <div ng-show="!searchingResults">
                          <div ng-show="error" class="alert alert-danger" role="alert">
                            {{message}}
                          </div>
                        </div>


                      <div ng-show="submittingBill">
                        <div  ng-class="alert_css" role="alert">
                          {{message}}
                        </div>
                      </div>


                      <div ng-show="Accountbilled" class="alert alert-danger" role="alert">
                        Sorry account has already been billed for the month of <h3>{{activeBillingMonth.month | date:'MMM, yyyy'}}</h3>
                        </button>
                      </div>

                        <md-content ng-show="accountFound">
                          <md-content ng-show="!billed">
                            <md-content flex layout="row" layout-align="space-between center">
                              <h1 style="font-weight: 200;" class="money-color">KES {{totalBilled+totalCharges | number}}</h1>
                              <md-button class="md-primary md-raised" ng-click="submit();">Save Bill</md-button>
                            </md-content>

                            <div class="clearfix"></div>

                            <md-content flex layout="row" layout-align="space-between center">

                              <md-input-container>
                                <label>Previous Reading</label>
                                <input maxlength="6" required type="number" ng-change="calcUnits()" name="meterReading"
                                       ng-model="form.previousReading">

                                <div ng-messages="myForm.object.previousReading.$error">
                                  <div ng-message="required">This is required.</div>
                                  <div ng-message="maxlength">The account number has to be less than 9 characters long.</div>
                                </div>
                              </md-input-container>


                            <md-input-container>
                              <label>Meter Reading</label>
                              <input maxlength="6" required type="number" ng-change="calcUnits()" name="meterReading"
                                     ng-model="form.meterReading">

                              <div ng-messages="myForm.object.meterReading.$error">
                                <div ng-message="required">This is required.</div>
                                <div ng-message="maxlength">The account number has to be less than 9 characters long.</div>
                              </div>
                            </md-input-container>

                              </md-content>

                            <md-content flex layout="row" layout-align="space-between center">


                              <md-input-container>
                                <label>Units Consumed</label>
                                <input readonly ng-model="form.unitsConsumed" ng-change="calcBilled()">
                              </md-input-container>

                              <md-input-container>
                                <label>Consumption Type</label>
                                <input readonly ng-model="form.consumptionType">
                              </md-input-container>

                            </md-content>

                            <md-subheader class="md-primary">Charged</md-subheader>
                            <md-content>
                <span class="label label-success pull-left" ng-repeat="charge in charged"
                      ng-click="removeCharge($index)">
                  {{charge.name | uppercase}} KES {{charge.amount | number}}
                </span>
                            </md-content>
                            <br/>
                            <md-divider></md-divider>

                            <md-subheader class="md-primary">Available Charges</md-subheader>
                            <md-content>
                <span class="label label-danger pull-left" ng-repeat="charge in charges" ng-click="addCharge($index)">
                {{charge.name | uppercase}} KES {{charge.amount | number}}
              </span>


                            </md-content>


                          </md-content>
                        </md-content>



                    </md-content>
                  </td>
                </tr>
              </table>
            </div>
            </td>
          </tr>
        </table>
      </form>
    </md-card-content>
  </md-card>
</md-content>
